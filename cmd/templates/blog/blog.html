{% extends 'base.html' %}

{% block app_content %}
    <div class="row">
        <div class="col-xs-12">
            <h1>{{ title }}</h1> 
            <p>{{ description }}
            {% if current_user.is_authenticated %}
            <a class="btn btn-default" href="{{ url_for('blog.new_post') }}">New post.</a>
            {% endif %}
            </p>
            <hr>
        </div>
    </div>
    <div class="row">
        <div class="col-md-9 col-md-push-3">
            {% if post %}
            <h2 class="blog-title">
                {{ post.title }}
                {% if current_user.is_authenticated %}
                    {% if post.public %}<span class="label label-success">Public</span>
                    {% else %}<span class="label label-danger">Not public</span>
                    {% endif %}
                {% endif %}
            </h2>
            <p class="text-muted blog-byline">
                Posted by 
                <span class="label label-default">
                    {% if post.author.first_name and post.author.last_name %}
                    {{ post.author.first_name + ' ' + post.author.last_name }}
                    {% else %}
                    {{ post.author.username }}
                    {% endif %}
                </span>&nbsp;
                on {{ moment(post.timestamp).format('LL') }} 
                {% if current_user.is_authenticated %}
                <a class="btn btn-default" href="{{ url_for('blog.new_post', post_id=post.id) }}">Edit</a>
                {% endif %}
            </p>
            <hr>
            <p class="blog-body">
                {{ post.body|safe }}
            </p>
            {% else %}
            <p class="blog-body">No post to show.</p>
            {% endif %}
        </div>

        <div class="col-md-3 col-md-pull-9"
            <nav aria-label="Previous and next page navigation">
                <ul class="pagination">
                    <li class="page-item{% if not next_url %} disabled{% endif %}">
                        {% if not next_url %}
                        <span class="page-link">
                            <i aria-hidden="true" class="fas fa-angle-left"></i> Next post
                        </span>
                        {% else %}
                        <a class="page-link" href="{{ next_url }}">
                            <i aria-hidden="true" class="fas fa-angle-left"></i> Next post
                        </a>
                        {% endif %}
                    </li>
                    <li class="page-item{% if not prev_url %} disabled{% endif %}">
                        {% if not prev_url %}
                        <span class="page-link">
                            Previous post 
                            <i aria-hidden="true" class="fas fa-angle-right"></i>
                        </span>
                        {% else %}
                        <a class="page-link" href="{{ prev_url }}">
                            Previous post 
                            <i aria-hidden="true" class="fas fa-angle-right"></i>
                        </a>
                        {% endif %}
                    </li>
                </ul>
            </nav>
            {% if g.post_list %}
            <h4>Past posts</h4>
            <div class="list-group">
                {% for p in g.post_list %}
                <a href="{{ url_for('blog.main', post=p.id) }}" class="list-group-item">{{ p.title }}</a>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>

{% endblock %}