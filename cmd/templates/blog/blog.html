{% extends 'base.html' %}

{% block app_content %}
    <div class="row blog-header">
        <div class="col-xs-12">
            <h1>{{ title }}</h1> 
            <p>{{ description }}
            {% if current_user.is_authenticated %}
            <a class="btn btn-default" href="{{ url_for('blog.new_post') }}">New post.</a>
            {% endif %}
            </p>
        </div>
    </div>
    <div class="row">
        <div class="col-md-9 col-md-push-3">
            {% if post %}
            <h2 class="blog-title">
                {{ post.title }}
                {% if current_user.is_authenticated %}
                    <span class="h3">{% if post.public %}<span class="label label-success">Public</span>
                    {% else %}<span class="label label-danger">Not public</span>
                    {% endif %}</span>
                {% endif %}
            </h2>
            <p class="text-muted blog-byline">
                Posted by 
                <span class="label label-default">
                    {% if post.author.first_name and post.author.last_name %}
                    {{ post.author.first_name + ' ' + post.author.last_name }}
                    {% else %}
                    {{ post.author.username }}
                    {% endif %}
                </span>&nbsp;
                on {{ moment(post.timestamp).format('LL') }} 
                
                {% if post.tags %}
                {% for tag in post.tags %}
                <span class="label label-info">{{ tag }}</span>
                {% endfor %}
                {% endif %}
                {% if current_user.is_authenticated %}
                <a class="btn btn-default pull-right" href="{{ url_for('blog.new_post', post_id=post.id) }}">Edit</a>
                {% endif %}
            </p>
            <hr>
            <p class="blog-body">
                {{ post.body|safe }}
            </p>
            {% else %}
            <p class="blog-body">No post to show.</p>
            {% endif %}
        </div>

        <div class="col-md-3 col-md-pull-9">
            <div aria-label="Previous and next page navigation" class="prev-next-buttons">
                <a class="btn btn-default{% if not next_url %} disabled{% endif %}" href="{{ next_url }}">
                    <i aria-hidden="true" class="fas fa-angle-left"></i> Next
                </a>
                <a class="btn btn-default{% if not prev_url %} disabled{% endif %}" href="{{ prev_url }}">
                    Previous <i aria-hidden="true" class="fas fa-angle-right"></i>
                </a>
            </div>

            {% if g.post_list %}
            <h4>Recent posts</h4>
            <div class="list-group blog-recent-posts">
                {% for post in g.post_list %}
                <a href="{{ post.url }}" class="list-group-item">{{ post.title }}</a>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>

{% endblock %}